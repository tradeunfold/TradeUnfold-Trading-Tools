<div id="tu-final-architect" style="max-width: 100%; margin: 20px auto; padding: 20px; border-radius: 15px; font-family: sans-serif; background: #0f172a; color: #f8fafc; border: 1px solid #1e293b; direction: ltr; box-sizing: border-box;">
    
    <h2 style="color: #38bdf8; text-align: center; font-size: 22px;">TradeUnfold Architect</h2>
    
    <div style="margin-bottom: 15px;">
        <label style="font-size: 11px; color: #94a3b8; text-transform: uppercase;">Asset</label>
        <select id="tu-symbol" style="width: 100%; padding: 10px; background: #1e293b; border: 1px solid #334155; border-radius: 8px; color: white;">
            <option value="EURUSD">EUR/USD</option>
            <option value="GBPUSD">GBP/USD</option>
            <option value="USDJPY">USD/JPY</option>
            <option value="XAUUSD">GOLD</option>
            <option value="BTCUSD">BITCOIN</option>
        </select>
    </div>

    <div style="display: flex; gap: 10px; margin-bottom: 15px;">
        <div style="flex: 1;">
            <label style="font-size: 11px; color: #f87171;">Risk Amount ($)</label>
            <input type="number" id="tu-loss-money" value="100" style="width: 100%; padding: 10px; background: #0f172a; border: 1px solid #334155; border-radius: 8px; color: white;">
        </div>
        <div style="flex: 1;">
            <label style="font-size: 11px; color: #38bdf8;">Trade Size (Lots)</label>
            <input type="number" id="tu-lots" value="1.0" step="0.01" style="width: 100%; padding: 10px; background: #0f172a; border: 1px solid #334155; border-radius: 8px; color: white;">
        </div>
    </div>

    <button type="button" onclick="window.calculateTrade()" style="width: 100%; padding: 15px; background: #38bdf8; color: #0f172a; border: none; border-radius: 10px; font-weight: 800; cursor: pointer;">CALCULATE</button>

    <div id="tu-final-results" style="margin-top: 20px; display: none; background: #1e293b; padding: 15px; border-radius: 10px; border: 1px solid #334155;">
        <div style="text-align: center; margin-bottom: 10px;">
            <span style="color: #94a3b8; font-size: 12px;">STOP LOSS DISTANCE</span>
            <div id="res-sl-pips" style="font-size: 30px; font-weight: 800; color: #f87171;">-</div>
            <span style="font-size: 12px; color: #94a3b8;">PIPS</span>
        </div>
    </div>
</div>

<script>
window.calculateTrade = async function() {
    const symbol = document.getElementById('tu-symbol').value;
    const lossAmt = parseFloat(document.getElementById('tu-loss-money').value);
    const lots = parseFloat(document.getElementById('tu-lots').value);

    try {
        const response = await fetch('https://api.exchangerate-api.com/v4/latest/USD');
        const data = await response.json();
        const rates = data.rates;

        let isJpy = symbol.includes("JPY") || symbol.includes("XAU");
        let pipSize = isJpy ? 0.01 : 0.0001;
        let contractSize = symbol.includes("XAU") ? 100 : 100000;
        
        let quoteCurrency = symbol.substring(3);
        let pipValueInUSD = (pipSize * contractSize);
        if (quoteCurrency !== "USD" && rates[quoteCurrency]) {
            pipValueInUSD = pipValueInUSD / rates[quoteCurrency];
        }

        let slPips = lossAmt / (lots * pipValueInUSD);

        document.getElementById('res-sl-pips').innerText = Math.round(slPips);
        document.getElementById('tu-final-results').style.display = 'block';
    } catch (e) { 
        console.error(e);
        alert("Live Data Error. Please check your connection."); 
    }
};
</script>
